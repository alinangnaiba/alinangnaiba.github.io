---
---

<section id="projects" class="py-20 px-6 relative overflow-hidden">
  <!-- Background decoration -->
  <div class="absolute top-20 right-0 w-96 h-96 bg-gradient-to-bl from-primary-100/30 dark:from-primary-900/10 to-transparent rounded-full blur-3xl pointer-events-none"></div>
  
  <div class="container mx-auto max-w-6xl relative z-10">
    <h2 class="text-4xl font-bold mb-4 text-center bg-gradient-to-r from-slate-900 via-primary-800 to-slate-900 dark:from-slate-100 dark:via-primary-400 dark:to-slate-100 bg-clip-text text-transparent">
      GitHub Projects
    </h2>
    <p class="text-center text-slate-600 dark:text-slate-400 mb-12 max-w-2xl mx-auto">
      Some side projects and some where I just play around out of curiousity.
    </p>
    <div id="projects-container" class="grid md:grid-cols-2 lg:grid-cols-3 gap-6">
      <div class="col-span-full text-center py-8">
        <div class="inline-block animate-spin rounded-full h-12 w-12 border-b-2 border-primary-600"></div>
        <p class="mt-4 text-slate-600 dark:text-slate-400">Loading projects...</p>
      </div>
    </div>
    
    <!-- Pagination Controls -->
    <div id="pagination-container" class="hidden mt-8 flex items-center justify-center gap-2">
      <button 
        id="prev-page" 
        class="btn btn-secondary disabled:opacity-30 disabled:cursor-not-allowed"
        disabled
      >
        <i class="ph ph-caret-left text-base"></i>
        Previous
      </button>
      <div id="page-info" class="px-4 py-2 text-slate-700 dark:text-dark-text font-medium"></div>
      <button 
        id="next-page" 
        class="btn btn-secondary disabled:opacity-30 disabled:cursor-not-allowed"
      >
        Next
        <i class="ph ph-caret-right text-base"></i>
      </button>
    </div>
  </div>
</section>

<script>
  let allRepos: any[] = [];
  let currentPage = 1;
  const reposPerPage = 6;

  async function fetchGitHubRepos() {
    const container = document.getElementById('projects-container');
    if (!container) return;
    
    try {
      const response = await fetch('https://api.github.com/users/alinangnaiba/repos?sort=d&per_page=100');
      const repos = await response.json();
      
      if (!Array.isArray(repos) || repos.length === 0) {
        container.innerHTML = `
          <div class="col-span-full text-center py-8">
            <p class="text-slate-600 dark:text-slate-400">No public repositories found.</p>
          </div>
        `;
        return;
      }
      
      allRepos = repos.filter(repo => !repo.fork);
      
      if (allRepos.length > reposPerPage) {
        const paginationContainer = document.getElementById('pagination-container');
        if (paginationContainer) {
          paginationContainer.classList.remove('hidden');
        }
      }
      
      displayRepos();
    } catch (error) {
      console.error('Error fetching GitHub repos:', error);
      container.innerHTML = `
        <div class="col-span-full text-center py-8">
          <p class="text-red-600 dark:text-red-400">Failed to load projects. Please try again later.</p>
        </div>
      `;
    }
  }

  function displayRepos() {
    const container = document.getElementById('projects-container');
    if (!container) return;

    const startIndex = (currentPage - 1) * reposPerPage;
    const endIndex = startIndex + reposPerPage;
    const reposToDisplay = allRepos.slice(startIndex, endIndex);
    
    container.innerHTML = reposToDisplay
      .map(repo => `
        <div class="card card-interactive group p-6 flex flex-col">
          <div class="flex-grow">
            <h3 class="text-xl font-bold mb-2 text-slate-900 dark:text-slate-100">
              ${repo.name}
            </h3>
            <p class="text-slate-600 dark:text-slate-400 mb-4 line-clamp-2">
              ${repo.description || 'No description available'}
            </p>
            <div class="flex flex-wrap gap-2 mb-4">
              ${repo.language ? `
                <span class="badge badge-primary">
                  ${repo.language}
                </span>
              ` : ''}
              ${repo.topics ? repo.topics.slice(0, 3).map((topic: string) => `
                <span class="badge badge-tech">
                  ${topic}
                </span>
              `).join('') : ''}
            </div>
          </div>
          <div class="flex items-center justify-between text-sm text-slate-600 dark:text-slate-400 pt-4 border-t border-slate-200 dark:border-dark-border">
            <div class="flex items-center gap-4">
              <span class="flex items-center gap-1">
                <i class="ph-duotone ph-star text-base"></i>
                ${repo.stargazers_count}
              </span>
              <span class="flex items-center gap-1">
                <i class="ph-duotone ph-git-fork text-base"></i>
                ${repo.forks_count}
              </span>
            </div>
            <a 
              href="${repo.html_url}" 
              target="_blank" 
              rel="noopener noreferrer"
              class="text-primary-600 dark:text-primary-400 hover:text-primary-700 dark:hover:text-primary-300 font-medium flex items-center gap-1"
            >
              View
              <i class="ph ph-arrow-right text-sm"></i>
            </a>
          </div>
        </div>
      `).join('');
    
    updatePaginationControls();
  }

  function updatePaginationControls() {
    const totalPages = Math.ceil(allRepos.length / reposPerPage);
    const prevButton = document.getElementById('prev-page') as HTMLButtonElement;
    const nextButton = document.getElementById('next-page') as HTMLButtonElement;
    const pageInfo = document.getElementById('page-info');
    
    if (prevButton) {
      prevButton.disabled = currentPage === 1;
    }
    
    if (nextButton) {
      nextButton.disabled = currentPage === totalPages;
    }
    
    if (pageInfo) {
      pageInfo.textContent = `Page ${currentPage} of ${totalPages}`;
    }
  }

  function goToPreviousPage() {
    if (currentPage > 1) {
      currentPage--;
      displayRepos();
      document.getElementById('projects')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  }

  function goToNextPage() {
    const totalPages = Math.ceil(allRepos.length / reposPerPage);
    if (currentPage < totalPages) {
      currentPage++;
      displayRepos();
      document.getElementById('projects')?.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  }

  document.getElementById('prev-page')?.addEventListener('click', goToPreviousPage);
  document.getElementById('next-page')?.addEventListener('click', goToNextPage);
  
  fetchGitHubRepos();
</script>
