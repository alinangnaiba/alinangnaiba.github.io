---
import { experience } from "../data/experience";
---

<section id="experience" class="section bg-white dark:bg-dark-sidebar">
  <div class="section-container">
    <h2 class="heading-section">Professional Experience</h2>
    <div class="space-y-6">
      {
        experience.map((job, index) => (
          <div class="card card-hover group border-l-4 border-primary-600 bg-slate-50 p-6 dark:border-l-primary-500 dark:bg-dark-highlight">
            <div class="mb-4 flex flex-col gap-4 md:flex-row md:items-start md:justify-between">
              <div class="flex-1">
                <h3 class="mb-1 text-xl font-bold text-slate-900 dark:text-slate-100">
                  {job.title}
                </h3>
                <p class="mb-1 text-base font-semibold text-primary-600 dark:text-primary-400">
                  {job.company}
                </p>
              </div>
              <div class="text-sm text-slate-600 dark:text-slate-400 md:text-right">
                <div class="mb-0.5 font-medium">{job.period}</div>
                <div class="mb-0.5 font-medium">{job.location}</div>
              </div>
            </div>

            <div class="mb-3">
              <div class="mb-2 flex items-center gap-2">
                <i class="ph-duotone ph-code text-sm text-primary-600 dark:text-primary-400" />
                <span class="text-xs font-semibold uppercase tracking-wide text-slate-700 dark:text-slate-300">
                  Technologies
                </span>
              </div>
              <p class="rounded border border-transparent bg-slate-100 p-2 font-mono text-sm leading-relaxed text-slate-600 dark:border-dark-border dark:bg-dark-bg dark:text-slate-400">
                {job.technologies}
              </p>
            </div>

            <div>
              <button
                class="experience-toggle mb-3 flex items-center gap-2 text-sm font-medium text-primary-600 transition-colors hover:text-primary-700 dark:text-primary-400 dark:hover:text-primary-300"
                data-job-index={index}
              >
                <i class="ph-fill ph-caret-down text-base transition-transform duration-200" />
                <span class="toggle-text">Show responsibilities</span>
              </button>

              <ul class="responsibilities-list hidden space-y-2" data-job-index={index}>
                {job.responsibilities.map((resp) => (
                  <li class="flex gap-2 text-sm text-slate-700 dark:text-dark-text">
                    <span class="mt-1 flex-shrink-0 text-primary-600">â–¹</span>
                    <span>{resp}</span>
                  </li>
                ))}
              </ul>
            </div>
          </div>
        ))
      }
    </div>
  </div>
</section>

<script>
  const toggleButtons = document.querySelectorAll(".experience-toggle");

  toggleButtons.forEach((button) => {
    button.addEventListener("click", () => {
      const jobIndex = button.getAttribute("data-job-index");
      const responsibilitiesList = document.querySelector(
        `.responsibilities-list[data-job-index="${jobIndex}"]`
      );
      const icon = button.querySelector("i");
      const toggleText = button.querySelector(".toggle-text");

      if (responsibilitiesList && icon && toggleText) {
        const isHidden = responsibilitiesList.classList.contains("hidden");

        if (isHidden) {
          responsibilitiesList.classList.remove("hidden");
          icon.style.transform = "rotate(180deg)";
          toggleText.textContent = "Hide responsibilities";
        } else {
          responsibilitiesList.classList.add("hidden");
          icon.style.transform = "rotate(0deg)";
          toggleText.textContent = "Show responsibilities";
        }
      }
    });
  });
</script>
